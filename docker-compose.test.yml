# Automated Testing - Ephemeral n8n instance
# Usage: docker-compose -f docker-compose.test.yml up -d
# Data is NOT persisted - each run starts fresh

services:
  n8n-test:
    image: n8nio/n8n:latest
    container_name: n8n-test-instance
    ports:
      - "5679:5678"
    environment:
      N8N_HOST: localhost
      N8N_PORT: "5678"
      N8N_PROTOCOL: http
      WEBHOOK_URL: http://localhost:5679/
      DB_TYPE: sqlite
      N8N_DIAGNOSTICS_ENABLED: "false"
      N8N_PERSONALIZATION_ENABLED: "false"
      N8N_USER_MANAGEMENT_JWT_SECRET: "test-jwt-secret-for-testing-only"
    healthcheck:
      test: ["CMD", "wget", "--spider", "-q", "http://localhost:5678/healthz"]
      interval: 5s
      timeout: 5s
      retries: 10
      start_period: 10s
    restart: "no"
    # No volumes - ephemeral by design

networks:
  default:
    name: n8n-test-network
